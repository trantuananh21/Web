<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkpoint 2</title>
    <link rel="stylesheet" href="./index.css">
</head>
<body>
    <div class="container right-panel-active">
        <!-- Sign Up -->
        <div class="container__form container--signup">
                <h2 class="form__title">Sign Up</h2>
                <input type="text" name="email" placeholder="Email" class="input" id="email" />
                <input type="password" name="password" placeholder="Password" class="input" id="password"/>
                <button id="submit" class="btn">Sign Up</button>
                <button id="logIn" class="btn">Log In</button>
        </div>
    
        <!-- Overlay -->
        <div class="container__overlay">
            <div class="overlay">
                <div class="overlay__panel overlay--left">
                    <button class="btn" id="signIn">Log In</button>
                </div>
                <div class="overlay__panel overlay--right">
                    <button class="btn" id="signUp">Sign Up</button>
                </div>
            </div>
        </div>
    </div>



    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-analytics.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-auth.js";

        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyDantJX62rGkccQ_GCmbxYUlYGM7GzHhpk",
          authDomain: "jsi-15.firebaseapp.com",
          projectId: "jsi-15",
          storageBucket: "jsi-15.appspot.com",
          messagingSenderId: "524363690661",
          appId: "1:524363690661:web:56e8f201f275e85188934c",
          measurementId: "G-6DMZTPQPHD"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth();  

        // function submit(){
        //     var email = document.getElementById('email').value;
        //     var password = document.getElementById('password').value;
        //     createUserWithEmailAndPassword(auth, email, password)
        //     .then((userCredential) => {
        //         const user = userCredential.user

        //         const json = JSON.stringify(user);
        //         alert("Sucessfull");
        //         localStorage.setItem(email, json);
        //         window.location.href = 'http://127.0.0.1:5500/check_point2/home.html';
        //     })
        //     .catch((error) => {
        //         const errorCode = error.code;
        //         const errorMessage = error.message;

        //         alert(errorMessage);
        //     });
        // }
        // document.getElementById('submit').addEventListener('click', submit)

        document.getElementById('submit').addEventListener('click', (e)=>{
            var email = document.getElementById('email').value;
            var password = document.getElementById('password').value;
            createUserWithEmailAndPassword(auth, email, password)
            .then((userCredential) => {
                const user = {
                    email : email,
                    password : password,
                }

                const json = JSON.stringify(user);
                localStorage.setItem(email, json);
                alert("Đăng ký thành công rồi nhé");
                window.location.href = 'http://127.0.0.1:5500/check_point2/home.html';
            })
            .catch((error) => {
                const errorCode = error.code;
                const errorMessage = error.message;

                alert("Lỗi rồi nhé: " + errorMessage);
            });
        })

        document.getElementById('logIn').addEventListener('click', (e)=>{
            var email = document.getElementById('email').value;
            var password = document.getElementById('password').value;

            signInWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        // Signed in 
        const user = userCredential.user;

         alert('Đăng nhập thành công');
         window.location.href = 'http://127.0.0.1:5500/check_point2/home.html';
        // ...
      })
      .catch((error) => {
        const errorCode = error.code;
        const errorMessage = error.message;

        alert("Lỗi rồi nhé: " + errorMessage);
  });
        })
      </script>
      
</body>
</html>